# Парафія Церкви Успіння Пресвятої Богородиці — Куликів

Настільний застосунок для обліку членів церковної громади,
згрупованих за домашньою адресою. Реєструйте народження, хрещення, вінчання
та смерті, зберігайте повну історію подій і в будь-який момент експортуйте
дані до Excel або CSV.

---

## Вимоги

| Вимога | Деталі |
|---|---|
| Операційна система | Windows 10/11, Linux, macOS |
| Python | Версія 3.8 або новіша |
| tkinter | Входить до складу Python на Windows та macOS; для Linux — дивіться нижче |
| Інтернет | Потрібен лише один раз — для завантаження пакету `openpyxl` під час встановлення |

---

## Встановлення

### Windows

1. Встановіть Python з [python.org](https://www.python.org/downloads/)
   - Під час встановлення поставте галочку **«Add Python to PATH»**
2. Двічі клацніть на файл **`install.bat`**
3. Слідкуйте за повідомленнями на екрані
4. Після завершення встановлення натисніть будь-яку клавішу, щоб запустити застосунок

### Linux (Ubuntu / Debian)

Відкрийте термінал у папці `church_tracker` і виконайте:

```bash
sudo apt install python3-tk     # встановити tkinter, якщо ще не встановлено
bash install.sh
```

### macOS

Відкрийте термінал у папці `church_tracker` і виконайте:

```bash
bash install.sh
```

> Якщо tkinter відсутній — перевстановіть Python з [python.org](https://www.python.org/downloads/)
> або виконайте `brew install python-tk`

---

## Запуск застосунку

Після встановлення автоматично створюється ярлик запуску.

| Платформа | Команда |
|---|---|
| Windows | Двічі клацніть **`run.bat`** |
| Linux / macOS | Виконайте `bash run.sh` у терміналі |
| Будь-яка платформа | `python3 main.py` з папки `church_tracker` |

---

## Перший запуск

При першому запуску застосунок завантажить **зразкові дані** (4 адреси,
12 мешканців, кілька подій), щоб ви могли ознайомитись з інтерфейсом до
введення реальних даних. Коли будете готові — просто видаліть зразкові
адреси: їхні мешканці та події видаляться автоматично.

---

## Огляд інтерфейсу

Головне вікно поділено на дві панелі:

```
┌──────────────────┬──────────────────────────────────────────────┐
│  ЛІВА ПАНЕЛЬ     │  ПРАВА ПАНЕЛЬ                                │
│  Список адрес    │  Мешканці обраної адреси                     │
│                  │  + Журнал подій внизу                        │
└──────────────────┴──────────────────────────────────────────────┘
```

### Ліва панель — Адреси

- Список усіх адрес в алфавітному порядку
- Поруч з кожною адресою у дужках відображається кількість **активних** (живих) мешканців
- Клацніть на адресу, щоб переглянути її мешканців праворуч
- Двічі клацніть на адресу, щоб її редагувати
- Кнопки **+ Додати**, **Правити** та **Видалити** керують адресами

### Права панель — Мешканці

Таблиця показує всіх мешканців обраної адреси:

| Стовпець | Опис |
|---|---|
| Ім'я | Повне ім'я та прізвище |
| Дата народження | РРРР-ММ-ДД |
| Охрещений | так / ні |
| Одружений | так / ні |
| Статус | активний / помер |
| Дата смерті | РРРР-ММ-ДД (порожньо, якщо живий) |

Померлі мешканці відображаються **сірим** кольором.

### Кнопки дій

| Кнопка | Дія |
|---|---|
| **+ Додати члена** | Додати нову людину до цієї адреси |
| **Правити** | Редагувати дані обраної людини |
| **Записати подію** | Зафіксувати хрещення, шлюб, народження або смерть |
| **Відмітити померлим** | Швидко записати дату смерті обраної людини |
| **Видалити** | Видалити обрану людину з адреси (та всю її історію подій) |

### Журнал подій

Нижня частина правої панелі показує хронологічний журнал усіх подій
для всіх мешканців обраної адреси, від найновіших до найстаріших.

Кожен запис містить:
- Дату
- Іконку типу події (★ народження  ✝ хрещення  ♥ шлюб  ✟ смерть)
- Ім'я людини
- Опис (якщо вказано)

---

## Додавання нової адреси

1. Натисніть **+ Додати** на лівій панелі
2. Введіть адресу вулиці
3. За бажанням додайте примітку (наприклад, «кутовий будинок»)
4. Натисніть **Зберегти**

---

## Додавання нового мешканця

1. Оберіть адресу на лівій панелі
2. Натисніть **+ Додати члена**
3. Заповніть поля:
   - Ім'я та прізвище (обов'язкові)
   - Дата народження (РРРР-ММ-ДД)
   - Дата хрещення (РРРР-ММ-ДД)
   - Дата вінчання (РРРР-ММ-ДД)
   - Дата смерті (РРРР-ММ-ДД) — лише якщо людина вже померла
   - Примітки (необов'язково)
4. Натисніть **Зберегти**

> **Формат дат:** Усі дати вводяться у форматі `РРРР-ММ-ДД`
> (наприклад, `1985-06-15` для 15 червня 1985 року).
> Залиште поле порожнім, якщо дата невідома або не застосовується.
> Натисніть кнопку **✕** поруч з полем дати, щоб очистити його.

---

## Запис події

Щоб додати хрещення, шлюб або іншу подію для наявного мешканця:

1. Оберіть адресу, потім оберіть людину в таблиці
2. Натисніть **Записати подію**
3. Виберіть тип події зі списку: народження, хрещення, шлюб, смерть
4. Введіть дату (РРРР-ММ-ДД)
5. За бажанням додайте опис
6. Натисніть **Зберегти**

> Запис події **хрещення** або **шлюбу** автоматично оновить відповідну дату
> в картці людини.
> Запис події **смерті** автоматично відмітить людину як померлу.

---

## Відмітити людину як померлу

1. Оберіть адресу, потім оберіть людину в таблиці
2. Натисніть **Відмітити померлим**
3. Введіть дату смерті (РРРР-ММ-ДД)
4. Натисніть **Підтвердити**

Статус людини зміниться на *помер*, рядок посіріє, дата смерті з'явиться
в таблиці, а подія додасться до журналу.

---

## Редагування даних мешканця

1. Оберіть людину в таблиці
2. Натисніть **Редагувати**
3. Змініть потрібні поля
4. Натисніть **Зберегти**

---

## Експорт даних

Перейдіть до меню **Файл**:

| Пункт меню | Результат |
|---|---|
| **Експорт у CSV…** | Зберігає всіх мешканців у файл `.csv` (відкривається у Excel, Блокноті тощо) |
| **Експорт у Excel…** | Зберігає всіх мешканців у файл `.xlsx` з оформленим рядком заголовків |

Вас запитають, куди зберегти файл. Експорт включає всіх мешканців
з усіх адрес, відсортованих за прізвищем.

> **Примітка:** Для експорту в Excel потрібен пакет `openpyxl`.
> Він встановлюється автоматично інсталятором.
> Якщо з'являється помилка — виконайте `pip install openpyxl`.

---

## Імпорт даних

Щоб перенести дані з іншого комп'ютера, перейдіть до меню **Файл**:

| Пункт меню | Результат |
|---|---|
| **Імпорт з CSV…** | Завантажує мешканців із раніше експортованого файлу `.csv` |
| **Імпорт з Excel…** | Завантажує мешканців із раніше експортованого файлу `.xlsx` |

Імпорт використовує той самий порядок стовпців, що й експорт. Адреси
створюються автоматично, якщо їх ще немає. Мешканці з однаковим іменем
за тією самою адресою пропускаються (дублів не буде). Рядок статусу показує,
скільки записів імпортовано і скільки пропущено.

**Порада — перенести всі дані одразу:** Якщо потрібно скопіювати все на
інший комп'ютер (включно з повною історією подій), просто скопіюйте файл
`church.db`. Це найповніший спосіб резервного копіювання.

---

## Налаштування

### Змінити мову

Перейдіть до **Налаштування → Language / Мова…**, оберіть **English**
або **Українська** і натисніть Зберегти.
Нова мова набуде чинності при наступному запуску застосунку.

---

## Зберігання даних

Усі дані зберігаються у файлі **`church.db`** в тій самій папці, що й застосунок.
Це стандартний файл бази даних SQLite.

**Резервна копія:** Просто скопіюйте `church.db` у безпечне місце (USB-накопичувач,
хмарна папка тощо), щоб зробити резервну копію всіх ваших даних.

**Відновлення:** Замініть `church.db` резервною копією і перезапустіть застосунок.

---

## Створення автономного виконуваного файлу для Windows

Якщо ви хочете запускати застосунок на комп'ютері без встановленого Python:

```bash
pip install pyinstaller
pyinstaller --onefile --windowed --name "ChurchTracker" main.py
```

Файл `dist/ChurchTracker.exe` можна скопіювати на будь-який ПК з Windows
і запустити без встановлення Python.

---

## Вирішення проблем

| Проблема | Рішення |
|---|---|
| `ModuleNotFoundError: No module named 'tkinter'` | Linux: `sudo apt install python3-tk` |
| `No matching distribution found for tkinter` | tkinter не встановлюється через pip — використовуйте менеджер пакетів системи (дивіться вище) |
| Помилка експорту в Excel «openpyxl is not installed» | Виконайте `pip install openpyxl` |
| Застосунок не запускається на Windows | Переконайтесь, що Python додано до PATH; спробуйте запустити `python main.py` у командному рядку |
| При першому запуску з'являються зразкові дані | Це очікувана поведінка — видаліть зразкові адреси, коли будете готові вводити реальні дані |
| Помилка імпорту з Excel «openpyxl is not installed» | Виконайте `pip install openpyxl` |
